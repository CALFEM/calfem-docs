exs_spring
^^^^^^^^^^

.. index:: exs_spring

:Purpose:

    Show the basic steps in a finite element calculation.

:Description:

    The general procedure in linear finite element calculations is carried out for a simple structure. The steps are:

    * Define the model
    * Generate element matrices
    * Assemble element matrices into the global system of equations
    * Solve the global system of equations
    * Evaluate element forces

    Consider the system of three linear elastic springs, and the corresponding finite element model. The system of springs is fixed in its ends and loaded by a single load :math:`F`.

    .. figure:: images/exs1_1.png
        :align: center

    .. figure:: images/exs1_2.png
        :align: center

:Example:

    The computation is initialized by defining the topology matrix :code:`Edof`, containing element numbers and global element degrees of freedom:

    .. code-block:: matlab

        >> Edof=[1  1 2;
                 2  2 3;
                 3  2 3];

    The global stiffness matrix :code:`K` (3Ã—3) of zeros:

    .. code-block:: matlab

        >> K=zeros(3,3)

        K =
             0     0     0
             0     0     0
             0     0     0

    And the load vector :code:`f` (3Ã—1) with the load :math:`F=100` in position 2:

    .. code-block:: matlab

        >> f=zeros(3,1);  f(2)=100

        f =
              0
            100
              0

    Element stiffness matrices are generated by the function :code:`spring1e`. The element property :code:`ep` for the springs contains the spring stiffnesses :math:`k` and :math:`2k` respectively, where :math:`k=1500`:

    .. code-block:: matlab

        >> k=1500;  ep1=k;  ep2=2*k;
        >> Ke1=spring1e(ep1)

        Ke1 =
                1500       -1500
               -1500        1500

        >> Ke2=spring1e(ep2)

        Ke2 =
                3000       -3000
               -3000        3000

    The element stiffness matrices are assembled into the global stiffness matrix :code:`K` according to the topology:

    .. code-block:: matlab

        >> K=assem(Edof(1,:),K,Ke2)

        K =
                3000       -3000           0
               -3000        3000           0
                   0           0           0

        >> K=assem(Edof(2,:),K,Ke1)

        K =
                3000       -3000           0
               -3000        4500       -1500
                   0       -1500        1500

        >> K=assem(Edof(3,:),K,Ke2)

        K =
                3000       -3000           0
               -3000        7500       -4500
                   0       -4500        4500

    The global system of equations is solved considering the boundary conditions given in :code:`bc`:

    .. code-block:: matlab

        >> bc= [1 0; 3 0];
        >> [a,r]=solveq(K,f,bc)

        a =
                 0
            0.0133
                 0

        r =

          -40.0000
                 0
          -60.0000

    Element forces are evaluated from the element displacements. These are obtained from the global displacements :code:`a` using the function :code:`extract`:

    .. code-block:: matlab

        >> ed1=extract_ed(Edof(1,:),a)

        ed1 =
              0      0.0133

        >> ed2=extract_ed(Edof(2,:),a)

        ed2 =
              0.0133      0

        >> ed3=extract_ed(Edof(3,:),a)

        ed3 =
              0.0133      0

    The spring forces are evaluated using the function :code:`spring1s`:

    .. code-block:: matlab

        >> es1=spring1s(ep2,ed1)

        es1 =
               40

        >> es2=spring1s(ep1,ed2)

        es2 =
              -20

        >> es3=spring1s(ep2,ed3)

        es3 =
              -40
