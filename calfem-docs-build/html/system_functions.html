


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="plate_functions.html">
      
      
        <link rel="next" href="statements.html">
      
      
      <link rel="icon" href="">
    
    
      
        <title>System functions - CALFEM - A Finite Element Toolbox 0.1 documentation</title>
      
    
    
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="_static/sphinx_immaterial_theme.a13aa284f557a42ea.min.css?v=8dc3467f" />
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#static-system-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="CALFEM - A Finite Element Toolbox 0.1 documentation" class="md-header__button md-logo" aria-label="CALFEM - A Finite Element Toolbox 0.1 documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CALFEM - A Finite Element Toolbox 0.1 documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              System functions
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/CALFEM/calfem-python/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    CALFEM for Python
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="CALFEM - A Finite Element Toolbox 0.1 documentation" class="md-nav__button md-logo" aria-label="CALFEM - A Finite Element Toolbox 0.1 documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    CALFEM - A Finite Element Toolbox 0.1 documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CALFEM/calfem-python/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    CALFEM for Python
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Contents:<wbr>
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Contents:<wbr>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="general_purpose_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General purpose functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="matrix_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Matrix functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="material_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Material functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="element_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Element functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="spring_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spring element functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="bar_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bar element functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="heat_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Heat Flow Elements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="solid_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solid elements functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="beam_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Beam element functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="plate_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plate element functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    System functions
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    System functions
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#static-system-functions" class="md-nav__link">
    
    <span class="md-ellipsis">
      Static system functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static system functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#assem" class="md-nav__link">
    
    <span class="md-ellipsis">
      assem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coordxtr" class="md-nav__link">
    
    <span class="md-ellipsis">
      coordxtr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eigen" class="md-nav__link">
    
    <span class="md-ellipsis">
      eigen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-ed" class="md-nav__link">
    
    <span class="md-ellipsis">
      extract_<wbr>ed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#red" class="md-nav__link">
    
    <span class="md-ellipsis">
      red
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solveq" class="md-nav__link">
    
    <span class="md-ellipsis">
      solveq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statcon" class="md-nav__link">
    
    <span class="md-ellipsis">
      statcon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-system-functions" class="md-nav__link">
    
    <span class="md-ellipsis">
      Dynamic system functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic system functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyna2" class="md-nav__link">
    
    <span class="md-ellipsis">
      dyna2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyna2f" class="md-nav__link">
    
    <span class="md-ellipsis">
      dyna2f
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fft" class="md-nav__link">
    
    <span class="md-ellipsis">
      fft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#freqresp" class="md-nav__link">
    
    <span class="md-ellipsis">
      freqresp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gfunc" class="md-nav__link">
    
    <span class="md-ellipsis">
      gfunc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="gfunc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ifft" class="md-nav__link">
    
    <span class="md-ellipsis">
      ifft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ritz" class="md-nav__link">
    
    <span class="md-ellipsis">
      ritz
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spectra" class="md-nav__link">
    
    <span class="md-ellipsis">
      spectra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step1" class="md-nav__link">
    
    <span class="md-ellipsis">
      step1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2" class="md-nav__link">
    
    <span class="md-ellipsis">
      step2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sweep" class="md-nav__link">
    
    <span class="md-ellipsis">
      sweep
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="statements.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Statements
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="graphics_functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Graphics functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#static-system-functions" class="md-nav__link">
    
    <span class="md-ellipsis">
      Static system functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Static system functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#assem" class="md-nav__link">
    
    <span class="md-ellipsis">
      assem
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coordxtr" class="md-nav__link">
    
    <span class="md-ellipsis">
      coordxtr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eigen" class="md-nav__link">
    
    <span class="md-ellipsis">
      eigen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extract-ed" class="md-nav__link">
    
    <span class="md-ellipsis">
      extract_<wbr>ed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#red" class="md-nav__link">
    
    <span class="md-ellipsis">
      red
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solveq" class="md-nav__link">
    
    <span class="md-ellipsis">
      solveq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statcon" class="md-nav__link">
    
    <span class="md-ellipsis">
      statcon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dynamic-system-functions" class="md-nav__link">
    
    <span class="md-ellipsis">
      Dynamic system functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamic system functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyna2" class="md-nav__link">
    
    <span class="md-ellipsis">
      dyna2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyna2f" class="md-nav__link">
    
    <span class="md-ellipsis">
      dyna2f
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fft" class="md-nav__link">
    
    <span class="md-ellipsis">
      fft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#freqresp" class="md-nav__link">
    
    <span class="md-ellipsis">
      freqresp
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gfunc" class="md-nav__link">
    
    <span class="md-ellipsis">
      gfunc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="gfunc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ifft" class="md-nav__link">
    
    <span class="md-ellipsis">
      ifft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ritz" class="md-nav__link">
    
    <span class="md-ellipsis">
      ritz
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spectra" class="md-nav__link">
    
    <span class="md-ellipsis">
      spectra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step1" class="md-nav__link">
    
    <span class="md-ellipsis">
      step1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step2" class="md-nav__link">
    
    <span class="md-ellipsis">
      step2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sweep" class="md-nav__link">
    
    <span class="md-ellipsis">
      sweep
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="system-functions">System functions<a class="headerlink" href="#system-functions" title="Link to this heading">¶</a></h1>
<p>The group of system functions comprises functions for the setting up, solving,
and elimination of systems of equations. The functions are separated
in two groups:</p>
<ul class="simple">
<li><p>Static system functions</p></li>
<li><p>Dynamic system functions</p></li>
</ul>
<p>Static system functions concern the linear system of equations</p>
<div class="math notranslate nohighlight">
\[\mathbf{K} \mathbf{a} = \mathbf{f}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is the global stiffness matrix and <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> is the global load
vector. Often used static system functions are <code class="docutils literal notranslate"><span class="pre">assem</span></code> and <code class="docutils literal notranslate"><span class="pre">solveq</span></code>.
The function <code class="docutils literal notranslate"><span class="pre">assem</span></code> assembles the global stiffness matrix and <code class="docutils literal notranslate"><span class="pre">solveq</span></code>
computes the global displacement vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> considering the
boundary conditions. It should be noted that <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{f}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>
also represent analogous quantities in systems other than structural mechanical systems.
For example, in a heat flow problem <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> represents the conductivity matrix,
<span class="math notranslate nohighlight">\(\mathbf{f}\)</span> the heat flow, and <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> the temperature.</p>
<p>Dynamic system functions are related to different aspects of linear
dynamic systems of coupled ordinary differential equations according to</p>
<div class="math notranslate nohighlight">
\[\mathbf{C} \dot{\mathbf{a}} + \mathbf{K} \mathbf{a} = \mathbf{f}\]</div>
<p>for first-order systems and</p>
<div class="math notranslate nohighlight">
\[\mathbf{M} \ddot{\mathbf{a}} + \mathbf{C} \dot{\mathbf{a}} + \mathbf{K} \mathbf{a} = \mathbf{f}\]</div>
<p>for second-order systems. First-order systems occur typically in transient
heat conduction and second-order systems occur in structural dynamics.</p>
<h2 id="static-system-functions">Static system functions<a class="headerlink" href="#static-system-functions" title="Link to this heading">¶</a></h2>
<p>The group of static system functions comprises functions for setting up and solving
the global system of equations. It also contains a function for eigenvalue
analysis, a function for static condensation, a function for extraction of element
displacements from the global displacement vector and a function for extraction of element
coordinates.</p>
<h3 id="assem">assem<a class="headerlink" href="#assem" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Assemble element matrices.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/ASSEM.png"><img alt="_images/ASSEM.png" src="_images/ASSEM.png" style="width: 70%;" />
</a>
</figure>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">K</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">assem</span><span class="p">(</span><span class="n">edof</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">Ke</span><span class="p">)</span>
<span class="p">[</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">assem</span><span class="p">(</span><span class="n">edof</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">Ke</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">fe</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">assem</span></code> adds the element stiffness matrix <span class="math notranslate nohighlight">\(\mathbf{K}^e\)</span>, stored in <code class="docutils literal notranslate"><span class="pre">Ke</span></code>, to the structure stiffness matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span>, stored in <code class="docutils literal notranslate"><span class="pre">K</span></code>, according to the topology matrix <span class="math notranslate nohighlight">\(\mathbf{edof}\)</span>.</p>
<p>The element topology matrix <span class="math notranslate nohighlight">\(\mathbf{edof}\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\mathbf{edof} = [el \quad  \underbrace{dof_1\quad dof_2\quad\ldots \quad dof_{ned}}_{\text{global dof.}} ]\]</div>
<p>where the first column contains the element number, and columns 2 to <span class="math notranslate nohighlight">\((ned+1)\)</span> contain the corresponding global degrees of freedom (<span class="math notranslate nohighlight">\(ned\)</span> = number of element degrees of freedom).</p>
<p>In the case where the matrix <span class="math notranslate nohighlight">\(\mathbf{K}^e\)</span> is identical for several elements, assembling of these can be carried out simultaneously. Each row in <span class="math notranslate nohighlight">\(\mathbf{Edof}\)</span> then represents one element, i.e. <span class="math notranslate nohighlight">\(nel\)</span> is the total number of considered elements.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{Edof} = \left. \left[
\begin{array}{c}
el_1 \\
el_2 \\
\vdots \\
el_{nel}
\end{array}
\quad
\begin{array}{cccccc}
dof_1 &amp; dof_2 &amp; \cdots &amp; \cdots &amp; \cdots &amp; dof_{ned} \\
dof_1 &amp; dof_2 &amp; \cdots &amp; \cdots &amp; \cdots &amp; dof_{ned} \\
\vdots &amp; \vdots &amp;  &amp;  &amp;  &amp; \vdots \\
dof_1 &amp; dof_2 &amp; \cdots &amp; \cdots &amp; \cdots &amp; dof_{ned}
\end{array}
\right] \right\} \text{one row for each element}\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(\mathbf{fe}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> are given in the function, the element load vector <span class="math notranslate nohighlight">\(\mathbf{f}^e\)</span> is also added to the global load vector <span class="math notranslate nohighlight">\(\mathbf{f}\)</span>.</p>
</dd>
</dl>
<h3 id="coordxtr">coordxtr<a class="headerlink" href="#coordxtr" title="Link to this heading">¶</a></h3>
<dl class="field-list" id="index-0">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Extract element coordinates from a global coordinate matrix.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/COORD.png"><img alt="_images/COORD.png" src="_images/COORD.png" style="width: 70%;" />
</a>
</figure>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">Ex</span><span class="p">,</span><span class="w"> </span><span class="n">Ey</span><span class="p">,</span><span class="w"> </span><span class="n">Ez</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">coordxtr</span><span class="p">(</span><span class="n">Edof</span><span class="p">,</span><span class="w"> </span><span class="n">Coord</span><span class="p">,</span><span class="w"> </span><span class="n">Dof</span><span class="p">,</span><span class="w"> </span><span class="n">nen</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">coordxtr</span></code> extracts element nodal coordinates from the global coordinate matrix <code class="docutils literal notranslate"><span class="pre">Coord</span></code> for elements with equal numbers of element nodes and dof’s.</p>
<p>Input variables are the element topology matrix <code class="docutils literal notranslate"><span class="pre">Edof</span></code>, defined in <code class="docutils literal notranslate"><span class="pre">assem</span></code>, the global coordinate matrix <code class="docutils literal notranslate"><span class="pre">Coord</span></code>, the global topology matrix <code class="docutils literal notranslate"><span class="pre">Dof</span></code>, and the number of element nodes <code class="docutils literal notranslate"><span class="pre">nen</span></code> in each element.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{Coord} = \begin{bmatrix}
x_1 &amp; y_1 &amp; [z_1] \\
x_2 &amp; y_2 &amp; [z_2] \\
x_3 &amp; y_3 &amp; [z_3] \\
\vdots &amp; \vdots &amp; \vdots \\
x_n &amp; y_n &amp; [z_n]
\end{bmatrix}
\qquad
\mathbf{Dof} = \begin{bmatrix}
k_1 &amp; l_1 &amp; \ldots &amp; m_1 \\
k_2 &amp; l_2 &amp; \ldots &amp; m_2 \\
k_3 &amp; l_3 &amp; \ldots &amp; m_3 \\
\vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
k_n &amp; l_n &amp; \ldots &amp; m_n
\end{bmatrix}
\qquad
nen = [\;nen\;]\end{split}\]</div>
<p>The nodal coordinates defined in row <em>i</em> of <code class="docutils literal notranslate"><span class="pre">Coord</span></code> correspond to the degrees of freedom of row <em>i</em> in <code class="docutils literal notranslate"><span class="pre">Dof</span></code>. The components <span class="math notranslate nohighlight">\(k_i\)</span>, <span class="math notranslate nohighlight">\(l_i\)</span> and <span class="math notranslate nohighlight">\(m_i\)</span> define the degrees of freedom of node <em>i</em>, and <em>n</em> is the number of global nodes for the considered part of the FE-model.</p>
<p>The output variables <code class="docutils literal notranslate"><span class="pre">Ex</span></code>, <code class="docutils literal notranslate"><span class="pre">Ey</span></code>, and <code class="docutils literal notranslate"><span class="pre">Ez</span></code> are matrices defined according to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{Ex} = \begin{bmatrix}
x_1^1 &amp; x_2^1 &amp; x_3^1 &amp; \ldots &amp; x_{nen}^1 \\
x_1^2 &amp; x_2^2 &amp; x_3^2 &amp; \ldots &amp; x_{nen}^2 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
x_1^{nel} &amp; x_2^{nel} &amp; x_3^{nel} &amp; \ldots &amp; x_{nen}^{nel}
\end{bmatrix}\end{split}\]</div>
<p>where row <em>i</em> gives the <em>x</em>-coordinates of the element defined in row <em>i</em> of <code class="docutils literal notranslate"><span class="pre">Edof</span></code>, and where <em>nel</em> is the number of considered elements.</p>
<p>The element coordinate data extracted by the function <code class="docutils literal notranslate"><span class="pre">coordxtr</span></code> can be used for plotting purposes and to create input data for the element stiffness functions.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>For the two dimensional beam element, the <code class="docutils literal notranslate"><span class="pre">extract</span></code> function will extract six nodal displacements for each element given in the first column vector in <code class="docutils literal notranslate"><span class="pre">Edof</span></code> and store them in the variable <code class="docutils literal notranslate"><span class="pre">ed</span></code> as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{ed} = \begin{bmatrix}
u_1 &amp; u_2 &amp; u_3 &amp; u_4 &amp; u_5 &amp; u_6 \\
u_1 &amp; u_2 &amp; u_3 &amp; u_4 &amp; u_5 &amp; u_6 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
u_1 &amp; u_2 &amp; u_3 &amp; u_4 &amp; u_5 &amp; u_6
\end{bmatrix}\end{split}\]</div>
</div>
</dd>
</dl>
<h3 id="eigen">eigen<a class="headerlink" href="#eigen" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Solve the generalized eigenvalue problem.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">eigen</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">)</span>
<span class="n">L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">eigen</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">[</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">eigen</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">)</span>
<span class="p">[</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">eigen</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">eigen</span></code> solves the eigenvalue problem</p>
<div class="math notranslate nohighlight">
\[| \mathbf{K} - \lambda \mathbf{M} | = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> are square matrices. The eigenvalues <span class="math notranslate nohighlight">\(\lambda\)</span> are stored in the vector <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> and the corresponding eigenvectors in the matrix <span class="math notranslate nohighlight">\(\mathbf{X}\)</span>.</p>
<p>If certain rows and columns in matrices <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> are to be eliminated in computing the eigenvalues, <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> must be given in the function. The rows (and columns) that are to be eliminated are described in the vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{b} = \begin{bmatrix}
dof_1 \\
dof_2 \\
\vdots \\
dof_{nb}
\end{bmatrix}\end{split}\]</div>
<p>The computed eigenvalues are given in order ranging from the smallest to the largest. The eigenvectors are normalized so that</p>
<div class="math notranslate nohighlight">
\[\mathbf{X}^T \mathbf{M} \mathbf{X} = \mathbf{I}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{I}\)</span> is the identity matrix.</p>
</dd>
</dl>
<h3 id="extract-ed">extract_ed<a class="headerlink" href="#extract-ed" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Extract element nodal quantities from a global solution vector.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/EXTRA.png"><img alt="_images/EXTRA.png" src="_images/EXTRA.png" style="width: 70%;" />
</a>
</figure>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">ed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">extract_ed</span><span class="p">(</span><span class="n">edof</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p>The <code class="docutils literal notranslate"><span class="pre">extract_ed</span></code> function extracts element displacements or corresponding quantities <span class="math notranslate nohighlight">\(\mathbf{a}^e\)</span> from the global solution vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>, stored in <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>Input variables are the element topology matrix <span class="math notranslate nohighlight">\(\mathbf{edof}\)</span>, defined in <code class="docutils literal notranslate"><span class="pre">assem</span></code>, and the global solution vector <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>The output variable</p>
<div class="math notranslate nohighlight">
\[\mathbf{ed} = (\mathbf{a}^e)^T\]</div>
<p>contains the element displacement vector.</p>
<p>If <span class="math notranslate nohighlight">\(\mathbf{Edof}\)</span> contains more than one element, <span class="math notranslate nohighlight">\(\mathbf{Ed}\)</span> will be a matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{Ed} = \begin{bmatrix}
    (\mathbf{a}^e)_1^T \\
    (\mathbf{a}^e)_2^T \\
    \vdots \\
    (\mathbf{a}^e)_{nel}^T
\end{bmatrix}\end{split}\]</div>
<p>where row <em>i</em> gives the element displacements for the element defined in row <em>i</em> of <code class="docutils literal notranslate"><span class="pre">Edof</span></code>, and <em>nel</em> is the total number of considered elements.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>For the two-dimensional beam element, the <code class="docutils literal notranslate"><span class="pre">extract</span></code> function will extract six nodal displacements for each element given in <span class="math notranslate nohighlight">\(\mathbf{Edof}\)</span>, and create a matrix <code class="docutils literal notranslate"><span class="pre">Ed</span></code> of size <em>(nel × 6)</em>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{Ed} = \begin{bmatrix}
    u_1 &amp; u_2 &amp; u_3 &amp; u_4 &amp; u_5 &amp; u_6 \\
    u_1 &amp; u_2 &amp; u_3 &amp; u_4 &amp; u_5 &amp; u_6 \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
    u_1 &amp; u_2 &amp; u_3 &amp; u_4 &amp; u_5 &amp; u_6
\end{bmatrix}\end{split}\]</div>
</dd>
</dl>
<h3 id="red">red<a class="headerlink" href="#red" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reduce the size of a square matrix by omitting rows and columns.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">B</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">red</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">red</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">red(A,</span> <span class="pre">b)</span></code> reduces the square matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> to a smaller matrix <code class="docutils literal notranslate"><span class="pre">B</span></code> by omitting rows and columns of <code class="docutils literal notranslate"><span class="pre">A</span></code>. The indices for rows and columns to be omitted are specified by the column vector <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>Assume that the matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \begin{bmatrix}
1 &amp; 2 &amp; 3 &amp; 4 \\
5 &amp; 6 &amp; 7 &amp; 8 \\
9 &amp; 10 &amp; 11 &amp; 12 \\
13 &amp; 14 &amp; 15 &amp; 16
\end{bmatrix}\end{split}\]</div>
<p>and <code class="docutils literal notranslate"><span class="pre">b</span></code> as</p>
<div class="math notranslate nohighlight">
\[\begin{split}b = \begin{bmatrix}
2 \\
4
\end{bmatrix}\end{split}\]</div>
<p>The statement <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">red(A,</span> <span class="pre">b)</span></code> results in the matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \begin{bmatrix}
1 &amp; 3 \\
9 &amp; 11
\end{bmatrix}\end{split}\]</div>
</dd>
</dl>
<h3 id="solveq">solveq<a class="headerlink" href="#solveq" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Solve equation system.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">solveq</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
<span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">solveq</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">)</span>
<span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">solveq</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p>The function <code class="docutils literal notranslate"><span class="pre">solveq</span></code> solves the equation system</p>
<div class="math notranslate nohighlight">
\[\mathbf{K}\;\mathbf{a} = \mathbf{f}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is a matrix and <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> are vectors.</p>
<p>The matrix <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> and the vector <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> must be predefined. The solution of the system of equations is stored in a vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> which is created by the function.</p>
<p>If some values of <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> are to be prescribed, the row number and the corresponding values are given in the boundary condition matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{bc} = \left[
\begin{array}{c}
dof_1 \\
dof_2 \\
\vdots \\
dof_{nbc}
\end{array}
\quad
\begin{array}{c}
u_1 \\
u_2 \\
\vdots \\
u_{nbc}
\end{array}
\right]\end{split}\]</div>
<p>where the first column contains the row numbers and the second column the corresponding prescribed values.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">r</span></code> is given in the function, support forces are computed according to</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = \mathbf{K}\;\mathbf{a} - \mathbf{f}\]</div>
</dd>
</dl>
<h3 id="statcon">statcon<a class="headerlink" href="#statcon" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reduce system of equations by static condensation.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">K1</span><span class="p">,</span><span class="w"> </span><span class="n">f1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">statcon</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
<span class="p">[</span><span class="n">K1</span><span class="p">,</span><span class="w"> </span><span class="n">f1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">statcon</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">[</span><span class="n">K1</span><span class="p">,</span><span class="w"> </span><span class="n">f1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">statcon</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">statcon</span></code> reduces a system of equations</p>
<div class="math notranslate nohighlight">
\[\mathbf{K}\;\mathbf{a} = \mathbf{f}\]</div>
<p>by static condensation.</p>
<p>The degrees of freedom to be eliminated are supplied to the function by the vector</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{b} = \begin{bmatrix}
dof_1 \\
dof_2 \\
\vdots \\
dof_{nb}
\end{bmatrix}\end{split}\]</div>
<p>where each row in <code class="docutils literal notranslate"><span class="pre">b</span></code> contains one degree of freedom to be eliminated.</p>
<p>The elimination gives the reduced system of equations</p>
<div class="math notranslate nohighlight">
\[\mathbf{K}_1\;\mathbf{a}_1 = \mathbf{f}_1\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{K}_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf{f}_1\)</span> are stored in <code class="docutils literal notranslate"><span class="pre">K1</span></code> and <code class="docutils literal notranslate"><span class="pre">f1</span></code> respectively.</p>
</dd>
</dl>
<h2 id="dynamic-system-functions">Dynamic system functions<a class="headerlink" href="#dynamic-system-functions" title="Link to this heading">¶</a></h2>
<p>The group of system functions comprises functions for solving linear dynamic systems
by time stepping or modal analysis, functions for frequency domain analysis, etc.</p>
<h3 id="dyna2">dyna2<a class="headerlink" href="#dyna2" title="Link to this heading">¶</a></h3>
<p>Compute the dynamic solution to a set of uncoupled second-order differential equations.</p>
<dl class="field-list">
<dt class="field-odd">Syntax<span class="colon">:</span></dt>
<dd class="field-odd"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">X</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dyna2</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span><span class="w"> </span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-even">Description<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">dyna2</span></code> computes the solution to the set</p>
<div class="math notranslate nohighlight">
\[\ddot{x}_i + 2 \xi_i \omega_i \dot{x}_i + \omega^{2}_i x_i = f_i g(t), \qquad i=1,\ldots,m\]</div>
<p>of differential equations, where <span class="math notranslate nohighlight">\(g(t)\)</span> is a piecewise linear time function.</p>
<p>The vectors <code class="docutils literal notranslate"><span class="pre">w2</span></code>, <code class="docutils literal notranslate"><span class="pre">xi</span></code>, and <code class="docutils literal notranslate"><span class="pre">f</span></code> contain the squared circular frequencies <span class="math notranslate nohighlight">\(\omega_i^2\)</span>, the damping ratios <span class="math notranslate nohighlight">\(\xi_i\)</span>, and the applied forces <span class="math notranslate nohighlight">\(f_i\)</span>, respectively.</p>
<p>The vector <code class="docutils literal notranslate"><span class="pre">g</span></code> defines the load function in terms of straight line segments between equally spaced points in time. This function may have been formed by the command <code class="docutils literal notranslate"><span class="pre">gfunc</span></code>.</p>
<p>The dynamic solution is computed at equal time increments defined by <code class="docutils literal notranslate"><span class="pre">dt</span></code>. Including the initial zero vector as the first column vector, the result is stored in the <span class="math notranslate nohighlight">\(m \times n\)</span> matrix <code class="docutils literal notranslate"><span class="pre">X</span></code>, where <span class="math notranslate nohighlight">\(n-1\)</span> is the number of time steps.</p>
</dd>
</dl>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>The accuracy of the solution is <em>not</em> a function of the output time increment <code class="docutils literal notranslate"><span class="pre">dt</span></code>, since the command produces the exact solution for straight line segments in the loading time function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">See also<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="xref std std-ref">gfunc</span></p>
</dd>
</dl>
<h3 id="dyna2f">dyna2f<a class="headerlink" href="#dyna2f" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute the dynamic solution to a set of uncoupled second-order differential equations.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">Y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dyna2f</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span><span class="w"> </span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dyna2f</span></code> computes the solution to the set of differential equations:</p>
<div class="math notranslate nohighlight">
\[\ddot{x}_i + 2 \xi_i\omega_i \dot{x}_i + \omega^{2}_i x_i = f_i g(t), \qquad i=1,\ldots,m\]</div>
<p>The vectors <code class="docutils literal notranslate"><span class="pre">w2</span></code>, <code class="docutils literal notranslate"><span class="pre">xi</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code> are the squared circular frequencies <span class="math notranslate nohighlight">\(\omega_i^2\)</span>, the damping ratios <span class="math notranslate nohighlight">\(\xi_i\)</span>, and the applied forces <span class="math notranslate nohighlight">\(f_i\)</span>, respectively. The force vector <code class="docutils literal notranslate"><span class="pre">p</span></code> contains the Fourier coefficients <span class="math notranslate nohighlight">\(p(k)\)</span> formed by the command <code class="docutils literal notranslate"><span class="pre">fft</span></code>.</p>
<p>The solution in the frequency domain is computed at equal time increments defined by <code class="docutils literal notranslate"><span class="pre">dt</span></code>. The result is stored in the <span class="math notranslate nohighlight">\(m \times n\)</span> matrix <code class="docutils literal notranslate"><span class="pre">Y</span></code>, where <code class="docutils literal notranslate"><span class="pre">m</span></code> is the number of equations and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of frequencies resulting from the <code class="docutils literal notranslate"><span class="pre">fft</span></code> command. The dynamic solution in the time domain is achieved by the use of the command <code class="docutils literal notranslate"><span class="pre">ifft</span></code>.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>The dynamic solution to a set of uncoupled second-order differential equations can be computed by the following sequence of commands:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">gfunc</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dyna2f</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span><span class="w"> </span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">);</span>
<span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="nb">real</span><span class="p">(</span><span class="nb">ifft</span><span class="p">(</span><span class="n">Y</span><span class="p">.</span><span class="o">&#39;</span><span class="p">)))</span><span class="o">&#39;</span><span class="p">;</span>
</code></pre></div>
</div>
<p>where it is assumed that the input variables <code class="docutils literal notranslate"><span class="pre">G</span></code>, <code class="docutils literal notranslate"><span class="pre">dt</span></code>, <code class="docutils literal notranslate"><span class="pre">w2</span></code>, <code class="docutils literal notranslate"><span class="pre">xi</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code> are properly defined. Note that the <code class="docutils literal notranslate"><span class="pre">ifft</span></code> command operates on column vectors if <code class="docutils literal notranslate"><span class="pre">Y</span></code> is a matrix; therefore use the transpose of <code class="docutils literal notranslate"><span class="pre">Y</span></code>. The output from the <code class="docutils literal notranslate"><span class="pre">ifft</span></code> command is complex. Therefore use <code class="docutils literal notranslate"><span class="pre">Y.'</span></code> to transpose rows and columns in <code class="docutils literal notranslate"><span class="pre">Y</span></code> in order to avoid the complex conjugate transpose of <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<p>The time response is represented by the real part of the output from the <code class="docutils literal notranslate"><span class="pre">ifft</span></code> command. If the transpose is used and the result is stored in a matrix <code class="docutils literal notranslate"><span class="pre">X</span></code>, each row will represent the time response for each equation as the output from the command <code class="docutils literal notranslate"><span class="pre">dyna2</span></code>.</p>
</dd>
<dt class="field-odd">See also<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="xref std std-ref">gfunc</span>, <span class="xref std std-ref">fft</span>, <span class="xref std std-ref">ifft</span></p>
</dd>
</dl>
<h3 id="fft">fft<a class="headerlink" href="#fft" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Transform functions in time domain to frequency domain.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p>The <code class="docutils literal notranslate"><span class="pre">fft</span></code> function transforms a time dependent function to the frequency domain.</p>
<p>The function to be transformed is stored in the vector <code class="docutils literal notranslate"><span class="pre">g</span></code>.
Each row in <code class="docutils literal notranslate"><span class="pre">g</span></code> contains the value of the function at equal time intervals.
The function represents a span <span class="math notranslate nohighlight">\(-\infty \leq t \leq +\infty\)</span>; however, only the values within a typical period are specified by <code class="docutils literal notranslate"><span class="pre">g</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">fft</span></code> command can be used with one or two input arguments.
If <code class="docutils literal notranslate"><span class="pre">N</span></code> is not specified, the number of frequencies used in the transformation is equal to the number of points in the time domain (i.e., the length of the variable <code class="docutils literal notranslate"><span class="pre">g</span></code>), and the output will be a vector of the same size containing complex values representing the frequency content of the input signal.</p>
<p>The scalar variable <code class="docutils literal notranslate"><span class="pre">N</span></code> can be used to specify the number of frequencies used in the Fourier transform. The size of the output vector in this case will be equal to <code class="docutils literal notranslate"><span class="pre">N</span></code>. It should be remembered that the highest harmonic component in the time signal that can be identified by the Fourier transform corresponds to half the sampling frequency. The sampling frequency is equal to <span class="math notranslate nohighlight">\(1/dt\)</span>, where <span class="math notranslate nohighlight">\(dt\)</span> is the time increment of the time signal.</p>
<p>The complex Fourier coefficients <span class="math notranslate nohighlight">\(p(k)\)</span> are stored in the vector <code class="docutils literal notranslate"><span class="pre">p</span></code>, and are computed according to</p>
<div class="math notranslate nohighlight">
\[p(k) = \sum_{j=1}^N x(j) \omega_N^{(j-1)(k-1)},\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\omega_N = e^{-2 \pi i / N}.\]</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>This is a MATLAB built-in function.</p>
</div>
</dd>
</dl>
<h3 id="freqresp">freqresp<a class="headerlink" href="#freqresp" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute frequency response of a known discrete time response.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">Freq</span><span class="p">,</span><span class="w"> </span><span class="n">Resp</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqresp</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">freqresp</span></code> computes the frequency response of a discrete dynamic system.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> is the time history function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code> is the sampling time increment, i.e., the time increment used in the time integration procedure.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Resp</span></code> contains the computed response as a function of frequency.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Freq</span></code> contains the corresponding frequencies.</p></li>
</ul>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>The result can be visualized by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="n">plot</span><span class="p">(</span><span class="n">Freq</span><span class="p">,</span> <span class="n">Resp</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="n">semilogy</span><span class="p">(</span><span class="n">Freq</span><span class="p">,</span> <span class="n">Resp</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The dimension of <code class="docutils literal notranslate"><span class="pre">Resp</span></code> is the same as that of the original time history function.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>The time history function of a discrete system computed by direct integration often behaves in an unstructured manner. The reason for this is that the time history is a mixture of several participating eigenmodes at different eigenfrequencies. By using a Fourier transform, however, the response as a function of frequency can be computed efficiently. In particular, it is possible to identify the participating frequencies.</p>
</div>
</dd>
</dl>
<h2 id="gfunc">gfunc<a class="headerlink" href="#gfunc" title="Link to this heading">¶</a></h2>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Form vector with function values at equally spaced points by linear interpolation.</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="_images/F32.png"><img alt="_images/F32.png" src="_images/F32.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-text"><span class="caption-text">
Piecewise linear time dependent function</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></figcaption>
</figure>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">gfunc</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">gfunc</span></code> uses linear interpolation to compute values at equally spaced points for a discrete function <span class="math notranslate nohighlight">\(g\)</span> given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}G = \left[
\begin{array}{cc}
t_1 &amp; g(t_1)\\
t_2 &amp; g(t_2)\\
\vdots \\
t_N &amp; g(t_N)
\end{array}
\right],\end{split}\]</div>
<p>as shown in the figure above.</p>
<p>Function values are computed in the range <span class="math notranslate nohighlight">\(t_1 \leq t \leq t_N\)</span>, at equal increments, <code class="docutils literal notranslate"><span class="pre">dt</span></code> being defined by the variable <code class="docutils literal notranslate"><span class="pre">dt</span></code>. The number of linear segments (steps) is <span class="math notranslate nohighlight">\((t_N-t_1)/dt\)</span>. The corresponding vector <code class="docutils literal notranslate"><span class="pre">t</span></code> is also computed. The result can be plotted by using the command <code class="docutils literal notranslate"><span class="pre">plot(t,</span> <span class="pre">g)</span></code>.</p>
</dd>
</dl>
<h3 id="ifft">ifft<a class="headerlink" href="#ifft" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Transform function in frequency domain to time domain.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ifft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">ifft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">ifft</span></code> transforms a function in the frequency domain to a function in the time domain.</p>
<p>The function to be transformed is given in the vector <code class="docutils literal notranslate"><span class="pre">y</span></code>. Each row in <code class="docutils literal notranslate"><span class="pre">y</span></code> contains Fourier terms in the interval <span class="math notranslate nohighlight">\(-\infty \leq \omega \leq +\infty\)</span>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ifft</span></code> command can be used with one or two input arguments. The scalar variable <code class="docutils literal notranslate"><span class="pre">N</span></code> can be used to specify the number of frequencies used in the Fourier transform. The size of the output vector in this case will be equal to <code class="docutils literal notranslate"><span class="pre">N</span></code>. See also the description of the command <code class="docutils literal notranslate"><span class="pre">fft</span></code>.</p>
<p>The inverse Fourier coefficients <span class="math notranslate nohighlight">\(x(j)\)</span>, stored in the variable <code class="docutils literal notranslate"><span class="pre">x</span></code>, are computed according to</p>
<div class="math notranslate nohighlight">
\[x(j) = \frac{1}{N} \sum_{k=1}^N y(k) \omega_N^{-(j-1)(k-1)},\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\omega_N = e^{-2 \pi i / N}.\]</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>This is a MATLAB built-in function.</p>
</div>
</dd>
<dt class="field-even">See also<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="xref std std-ref">fft</span></p>
</dd>
</dl>
<h3 id="ritz">ritz<a class="headerlink" href="#ritz" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute approximative eigenvalues and eigenvectors by the Lanczos method.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ritz</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="n">L</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ritz</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
<span class="p">[</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ritz</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">)</span>
<span class="p">[</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ritz</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">ritz</span></code> computes, by the use of the Lanczos algorithm, <code class="docutils literal notranslate"><span class="pre">m</span></code> approximative eigenvalues and <code class="docutils literal notranslate"><span class="pre">m</span></code> corresponding eigenvectors for a given pair of <em>n</em>-by-<em>n</em> matrices <code class="docutils literal notranslate"><span class="pre">K</span></code> and <code class="docutils literal notranslate"><span class="pre">M</span></code> and a given non-zero starting vector <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<p>If certain rows and columns in matrices <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> are to be eliminated in computing the eigenvalues, <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> must be given in the command. The rows (and columns) to be eliminated are described in the vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{b} = \begin{bmatrix}
dof_1 \\
dof_2 \\
\vdots \\
dof_{nb}
\end{bmatrix}\end{split}\]</div>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>If the number of vectors, <code class="docutils literal notranslate"><span class="pre">m</span></code>, is chosen less than the total number of degrees-of-freedom, <span class="math notranslate nohighlight">\(n\)</span>, only about the first <code class="docutils literal notranslate"><span class="pre">m/2</span></code> Ritz vectors are good approximations of the true eigenvectors. Recall that the Ritz vectors satisfy the <code class="docutils literal notranslate"><span class="pre">M</span></code>-orthonormality condition</p>
</div>
<div class="math notranslate nohighlight">
\[\mathbf{X}^T \mathbf{M} \mathbf{X} = \mathbf{I}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{I}\)</span> is the identity matrix.</p>
</dd>
</dl>
<h3 id="spectra">spectra<a class="headerlink" href="#spectra" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute seismic response spectra for elastic design.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">spectra</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p>The <code class="docutils literal notranslate"><span class="pre">spectra</span></code> function computes the seismic response spectrum for a known acceleration history function.</p>
<ul class="simple">
<li><p>The computation is based on the vector <code class="docutils literal notranslate"><span class="pre">a</span></code>, which contains an acceleration time history function defined at equal time steps.</p></li>
<li><p>The time step is specified by the variable <code class="docutils literal notranslate"><span class="pre">dt</span></code>.</p></li>
<li><p>The value of the damping ratio is given by the variable <code class="docutils literal notranslate"><span class="pre">xi</span></code>.</p></li>
<li><p>Output from the computation, stored in the vector <code class="docutils literal notranslate"><span class="pre">s</span></code>, is achieved at frequencies specified by the column vector <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>The following procedure can be used to produce a seismic response spectrum for a damping ratio <span class="math notranslate nohighlight">\(\xi = 0.05\)</span>, defined at 34 logarithmically spaced frequency points. The acceleration time history <code class="docutils literal notranslate"><span class="pre">a</span></code> has been sampled at a frequency of 50 Hz, corresponding to a time increment <code class="docutils literal notranslate"><span class="pre">dt</span> <span class="pre">=</span> <span class="pre">0.02</span></code> between collected points:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">log10</span><span class="p">(</span><span class="mi">2</span>^<span class="p">(</span><span class="mi">33</span><span class="o">/</span><span class="mi">6</span><span class="p">)),</span><span class="w"> </span><span class="mi">34</span><span class="p">);</span>
<span class="n">xi</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.05</span><span class="p">;</span>
<span class="n">dt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.02</span><span class="p">;</span>
<span class="n">s</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">spectra</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">xi</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">freq</span><span class="o">&#39;</span><span class="p">);</span>
</code></pre></div>
</div>
<p>The resulting spectrum can be plotted by the command:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="nb">loglog</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;*&#39;</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
</dl>
<h3 id="step1">step1<a class="headerlink" href="#step1" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute the dynamic solution to a set of first order differential equations.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">da</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">step1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="p">)</span>
<span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">da</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">step1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="p">)</span>
<span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="n">ahist</span><span class="p">,</span><span class="w"> </span><span class="n">dahist</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">step1</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">dofs</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">step1</span></code> computes at equal time steps the solution to a set of first order differential equations of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{C} \dot{\mathbf{a}} + \mathbf{K}\mathbf{a} = \mathbf{f}(x, t), \\
\mathbf{a}(0) = \mathbf{a}_0\end{split}\]</div>
<p>The command solves transient field problems. In the case of heat conduction, <code class="docutils literal notranslate"><span class="pre">K</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> represent the <span class="math notranslate nohighlight">\(n \times n\)</span> conductivity and capacity matrices, respectively. <code class="docutils literal notranslate"><span class="pre">a</span></code> is the temperature and <code class="docutils literal notranslate"><span class="pre">da</span></code> (i.e., <span class="math notranslate nohighlight">\(\dot{\mathbf{a}}\)</span>) is the time derivative of the temperature.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">f</span></code> contains the time-dependent load vectors. If no external loads are active, use <code class="docutils literal notranslate"><span class="pre">[]</span></code> for <code class="docutils literal notranslate"><span class="pre">f</span></code>. The matrix <code class="docutils literal notranslate"><span class="pre">f</span></code> is organized as follows:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span>
<span class="nb">time</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">dof_1</span>
<span class="nb">time</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">dof_2</span>
<span class="k">...</span>
<span class="nb">time</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nb">load</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">dof_n</span>
<span class="p">]</span>
</code></pre></div>
</div>
<p>The dimension of <code class="docutils literal notranslate"><span class="pre">f</span></code> is:</p>
<blockquote>
<div><p>(number of degrees-of-freedom) × (number of timesteps + 1)</p>
</div></blockquote>
<p>The initial conditions are given by the vector <code class="docutils literal notranslate"><span class="pre">a0</span></code> containing initial values of <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">bc</span></code> contains the time-dependent prescribed values of the field variable <code class="docutils literal notranslate"><span class="pre">a</span></code>. If no field variables are prescribed, use <code class="docutils literal notranslate"><span class="pre">[]</span></code> for <code class="docutils literal notranslate"><span class="pre">bc</span></code>. The matrix <code class="docutils literal notranslate"><span class="pre">bc</span></code> is organized as follows:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">bc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span>
<span class="n">dof_1</span><span class="w">   </span><span class="s">time</span><span class="w"> </span><span class="s">history</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">field</span><span class="w"> </span><span class="s">variable</span>
<span class="n">dof_2</span><span class="w">   </span><span class="s">time</span><span class="w"> </span><span class="s">history</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">field</span><span class="w"> </span><span class="s">variable</span>
<span class="k">...</span>
<span class="n">dof_m2</span><span class="w">  </span><span class="s">time</span><span class="w"> </span><span class="s">history</span><span class="w"> </span><span class="s">of</span><span class="w"> </span><span class="s">the</span><span class="w"> </span><span class="s">field</span><span class="w"> </span><span class="s">variable</span>
<span class="p">]</span>
</code></pre></div>
</div>
<p>The dimension of <code class="docutils literal notranslate"><span class="pre">bc</span></code> is:</p>
<blockquote>
<div><p>(number of dofs with prescribed field values) × (number of timesteps + 2)</p>
</div></blockquote>
<p>The time integration procedure is governed by the parameters given in the vector <code class="docutils literal notranslate"><span class="pre">ip</span></code> defined as:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">ip</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="nb">alpha</span><span class="p">]</span>
</code></pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">dt</span></code> specifies the length of the time increment, <code class="docutils literal notranslate"><span class="pre">T</span></code> is the total time, and <code class="docutils literal notranslate"><span class="pre">alpha</span></code> is the time integration constant. Frequently used values of <code class="docutils literal notranslate"><span class="pre">alpha</span></code> are:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>alpha</p></th>
<th class="head"><p>Method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Forward difference; forward Euler</p></td>
</tr>
<tr class="row-odd"><td><p>0.5</p></td>
<td><p>Trapezoidal rule; Crank-Nicholson</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>Backward difference; backward Euler</p></td>
</tr>
</tbody>
</table>
<p>The computed values of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">da</span></code> are stored in <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">da</span></code>, respectively. The first column contains the initial values, and the following columns contain the values for each time step. The dimension is:</p>
<blockquote>
<div><p>(number of degrees-of-freedom) × (number of time steps + 1)</p>
</div></blockquote>
<p>If the values are to be stored only for specific times, the parameter <code class="docutils literal notranslate"><span class="pre">times</span></code> specifies at which times the solution will be stored. The values are stored in <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">da</span></code>, one column for each requested time according to <code class="docutils literal notranslate"><span class="pre">times</span></code>. The dimension is then:</p>
<blockquote>
<div><p>(number of degrees-of-freedom) × (number of requested times + 1)</p>
</div></blockquote>
<p>If the history is to be stored in <code class="docutils literal notranslate"><span class="pre">ahist</span></code> and <code class="docutils literal notranslate"><span class="pre">dahist</span></code> for some degrees of freedom, the parameter <code class="docutils literal notranslate"><span class="pre">dofs</span></code> specifies for which degrees of freedom the history is to be stored. The computed time histories are stored in <code class="docutils literal notranslate"><span class="pre">ahist</span></code> and <code class="docutils literal notranslate"><span class="pre">dahist</span></code>, respectively, with one row for each requested degree of freedom. The dimension is:</p>
<blockquote>
<div><p>(number of specified degrees of freedom) × (number of timesteps + 1)</p>
</div></blockquote>
<p>The time history functions can be generated using the command <code class="docutils literal notranslate"><span class="pre">gfunc</span></code>. If all the values of the time histories of <code class="docutils literal notranslate"><span class="pre">f</span></code> or <code class="docutils literal notranslate"><span class="pre">bc</span></code> are kept constant, these values need to be stated only once. In this case, the number of columns in <code class="docutils literal notranslate"><span class="pre">f</span></code> is one and in <code class="docutils literal notranslate"><span class="pre">bc</span></code> two.</p>
<p>In most cases, only a few degrees-of-freedom are affected by the exterior load, and hence the matrix contains only a few non-zero entries. In such cases, it is possible to save space by defining <code class="docutils literal notranslate"><span class="pre">f</span></code> as <code class="docutils literal notranslate"><span class="pre">sparse</span></code> (a MATLAB built-in function).</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>Reference: Bathe, K.J.: <em>Finite Element Procedures in Engineering Analysis</em>, Prentice-Hall, Englewood Cliffs, New Jersey, pp. 511-514, 1982.</p>
</div>
</dd>
</dl>
<h3 id="step2">step2<a class="headerlink" href="#step2" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute the dynamic solution to a set of second order differential equations.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="n">d2a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">step2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">da0</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="p">)</span>
<span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="n">d2a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">step2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">da0</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="p">)</span>
<span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">da</span><span class="p">,</span><span class="w"> </span><span class="n">d2a</span><span class="p">,</span><span class="w"> </span><span class="n">ahist</span><span class="p">,</span><span class="w"> </span><span class="n">dahist</span><span class="p">,</span><span class="w"> </span><span class="n">d2ahist</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">step2</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">a0</span><span class="p">,</span><span class="w"> </span><span class="n">da0</span><span class="p">,</span><span class="w"> </span><span class="n">bc</span><span class="p">,</span><span class="w"> </span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">dofs</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">step2</span></code> computes at equal time steps the solution to a set of second order differential equations of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{M} \ddot{\mathbf{a}} + \mathbf{C} \dot{\mathbf{a}} + \mathbf{K} \mathbf{a} = \mathbf{f}(x, t), \\
\mathbf{a}(0) = \mathbf{a}_0, \\
\dot{\mathbf{a}}(0) = \mathbf{v}_0.\end{split}\]</div>
<p>In structural mechanics problems, <code class="docutils literal notranslate"><span class="pre">K</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">M</span></code> represent the <span class="math notranslate nohighlight">\(n \times n\)</span> stiffness, damping and mass matrices, respectively. <code class="docutils literal notranslate"><span class="pre">a</span></code> is the displacement, <code class="docutils literal notranslate"><span class="pre">da</span></code> ( = <span class="math notranslate nohighlight">\(\dot{\mathbf{a}}\)</span> ) is the velocity and <code class="docutils literal notranslate"><span class="pre">d2a</span></code> ( = <span class="math notranslate nohighlight">\(\ddot{\mathbf{a}}\)</span> ) is the acceleration.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">f</span></code> contains the time-dependent load vectors. If no external loads are active, use <code class="docutils literal notranslate"><span class="pre">[]</span></code> for <code class="docutils literal notranslate"><span class="pre">f</span></code>. The matrix <code class="docutils literal notranslate"><span class="pre">f</span></code> is organized as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f = \begin{bmatrix}
\text{time history of the load at } dof_1 \\
\text{time history of the load at } dof_2 \\
\vdots \\
\text{time history of the load at } dof_n
\end{bmatrix}\end{split}\]</div>
<p>The dimension of <code class="docutils literal notranslate"><span class="pre">f</span></code> is:</p>
<blockquote>
<div><p>(number of degrees-of-freedom) × (number of timesteps + 1)</p>
</div></blockquote>
<p>The initial conditions are given by the vectors <code class="docutils literal notranslate"><span class="pre">a0</span></code> and <code class="docutils literal notranslate"><span class="pre">da0</span></code>, containing initial displacements and initial velocities.</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">bc</span></code> contains the time-dependent prescribed displacement. If no displacements are prescribed, use <code class="docutils literal notranslate"><span class="pre">[]</span></code> for <code class="docutils literal notranslate"><span class="pre">bc</span></code>. The matrix <code class="docutils literal notranslate"><span class="pre">bc</span></code> is organized as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}bc = \begin{bmatrix}
dof_1 &amp; \text{time history of the displacement} \\
dof_2 &amp; \text{time history of the displacement} \\
\vdots &amp; \vdots \\
dof_{m_2} &amp; \text{time history of the displacement}
\end{bmatrix}\end{split}\]</div>
<p>The dimension of <code class="docutils literal notranslate"><span class="pre">bc</span></code> is:</p>
<blockquote>
<div><p>(number of dofs with prescribed displacement) × (number of timesteps + 2)</p>
</div></blockquote>
<p>The time integration procedure is governed by the parameters given in the vector <code class="docutils literal notranslate"><span class="pre">ip</span></code> defined as:</p>
<div class="math notranslate nohighlight">
\[ip = [dt, T, \alpha, \delta]\]</div>
<p>where <code class="docutils literal notranslate"><span class="pre">dt</span></code> specifies the time increment, <code class="docutils literal notranslate"><span class="pre">T</span></code> the total time, and <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">delta</span></code> are time integration constants for the Newmark family of methods.</p>
<p>Frequently used values:</p>
<table class="docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\delta\)</span></p></td>
<td><p>Method</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\frac{1}{4}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p>Average acceleration (trapezoidal) rule</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\frac{1}{6}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p>Linear acceleration</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1}{2}\)</span></p></td>
<td><p>Central difference</p></td>
</tr>
</tbody>
</table>
<p>The computed values of <span class="math notranslate nohighlight">\(\mathbf{a}\)</span>, <span class="math notranslate nohighlight">\(\dot{\mathbf{a}}\)</span> and <span class="math notranslate nohighlight">\(\ddot{\mathbf{a}}\)</span> are stored in <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">da</span></code> and <code class="docutils literal notranslate"><span class="pre">d2a</span></code>, respectively. The first column contains the initial values and the following columns contain the values for each time step.</p>
<p>The dimension of <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">da</span></code> and <code class="docutils literal notranslate"><span class="pre">d2a</span></code> is:</p>
<blockquote>
<div><p>(number of degrees-of-freedom) × (number of time steps + 1)</p>
</div></blockquote>
<p>If the values are to be stored only for specific times, the parameter <code class="docutils literal notranslate"><span class="pre">times</span></code> specifies at which times the solution will be stored. The values are stored in <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">da</span></code> and <code class="docutils literal notranslate"><span class="pre">d2a</span></code>, one column for each requested time according to <code class="docutils literal notranslate"><span class="pre">times</span></code>. The dimension is then:</p>
<blockquote>
<div><p>(number of degrees-of-freedom) × (number of requested times + 1)</p>
</div></blockquote>
<p>If the history is to be stored in <code class="docutils literal notranslate"><span class="pre">ahist</span></code>, <code class="docutils literal notranslate"><span class="pre">dahist</span></code> and <code class="docutils literal notranslate"><span class="pre">d2ahist</span></code> for some degrees of freedom, the parameter <code class="docutils literal notranslate"><span class="pre">dofs</span></code> specifies for which degrees of freedom the history is to be stored. The computed time histories are stored in <code class="docutils literal notranslate"><span class="pre">ahist</span></code>, <code class="docutils literal notranslate"><span class="pre">dahist</span></code> and <code class="docutils literal notranslate"><span class="pre">d2ahist</span></code>, one row for each requested degree of freedom according to <code class="docutils literal notranslate"><span class="pre">dofs</span></code>. The dimension is:</p>
<blockquote>
<div><p>(number of specified degrees of freedom) × (number of timesteps + 1)</p>
</div></blockquote>
<p>In most cases only a few degrees-of-freedom are affected by the exterior load, and hence the matrix contains only few non-zero entries. In such cases it is possible to save space by defining <code class="docutils literal notranslate"><span class="pre">f</span></code> as sparse (a MATLAB built-in function).</p>
</dd>
</dl>
<h3 id="sweep">sweep<a class="headerlink" href="#sweep" title="Link to this heading">¶</a></h3>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute complex frequency response functions.</p>
</dd>
<dt class="field-even">Syntax<span class="colon">:</span></dt>
<dd class="field-even"><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">Y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sweep</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">sweep</span></code> computes the complex frequency response function for a system of the form:</p>
<div class="math notranslate nohighlight">
\[[\mathbf{K} + i\omega\mathbf{C} - \omega^2 \mathbf{M} ]\mathbf{y}(\omega) = \mathbf{p}\]</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">K</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, and <code class="docutils literal notranslate"><span class="pre">M</span></code> represent the <em>m</em>-by-<em>m</em> stiffness, damping, and mass matrices, respectively. The vector <code class="docutils literal notranslate"><span class="pre">p</span></code> defines the amplitude of the force. The frequency response function is computed for the values of <span class="math notranslate nohighlight">\(\omega\)</span> given by the vector <code class="docutils literal notranslate"><span class="pre">w</span></code>.</p>
<p>The complex frequency response function is stored in the matrix <code class="docutils literal notranslate"><span class="pre">Y</span></code> with dimension <em>m</em>-by-<em>n</em>, where <em>n</em> is equal to the number of circular frequencies defined in <code class="docutils literal notranslate"><span class="pre">w</span></code>.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>The steady-state response can be computed by:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">X</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">real</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="nb">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">));</span>
</code></pre></div>
</div>
<p>and the amplitude by:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><code><span class="n">Z</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
</code></pre></div>
</div>
</dd>
</dl>







  
  






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2025, ....
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
      
        <script src="_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>